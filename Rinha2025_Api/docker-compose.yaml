version: "3.8"
services:
    nginx:
        image: nginx:1.25-alpine
        container_name: rinha-nginx
        volumes:
          - ./nginx.conf:/etc/nginx/nginx.conf:ro
        depends_on:
          - backend1
          - backend2
        ports:
          - "9999:9999"
        networks:
            - backend
            - payment-processor
        deploy:
            resources:
                limits:
                    cpus: "0.15"
                    memory: "15MB"     
    backend1:
        image: 'rnakatan/rinha2025api'
        container_name: backend1
        networks:
            - backend
            - payment-processor 
        deploy:
            resources:
                limits:
                    cpus: "0.15"
                    memory: "15MB"       
    backend2:
        image: 'rnakatan/rinha2025api'
        container_name: backend2
        networks:
            - backend
            - payment-processor
        deploy:
            resources:
                limits:
                    cpus: "0.15"
                    memory: "15MB"       
networks:
  backend:
    driver: bridge
  payment-processor:
    external: true        
    